<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/4b76110e/css/bootstrap.css" rel="stylesheet">
<link href="./assets/710de68d/style.css" rel="stylesheet">
<script src="./assets/75e46bf0/jquery.js"></script>
<script src="./assets/4b76110e/js/bootstrap.js"></script>
<script src="./assets/a44c75fa/jssearch.js"></script>    <title>Yii Framework 2.0 API Documentation</title>
</head>
<body>

<div class="wrap">
    <nav id="w20" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w20-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii Framework 2.0 API Documentation</a></div><div id="w20-collapse" class="collapse navbar-collapse"><ul id="w21" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li><a href="./guide-en-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Caching <a href="#caching" name="caching" class="hashlink">&para;</a></h1><h2>Overview and Base Concepts <a href="#overview-and-base-concepts" name="overview-and-base-concepts" class="hashlink">&para;</a></h2><p>Caching is a cheap and effective way to improve the performance of a web application. By storing relatively
static data in cache and serving it from cache when requested, we save the time needed to generate the data.</p>
<p>Using cache in Yii mainly involves configuring and accessing a cache application component. The following
application configuration specifies a cache component that uses <a href="http://memcached.org/">memcached</a> with
two cache servers. Note, this configuration should be done in file located at <code>@app/config/web.php</code> alias
in case you're using basic sample application.</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #DD0000">'components'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cache'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'\yii\caching\MemCache'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'servers'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'host'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'server1'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'port'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'weight'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'host'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'server2'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'port'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'weight'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">50</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;],<br />],</span></code></pre>
<p>When the application is running, the cache component can be accessed through <code>Yii::$app-&gt;cache</code> call.</p>
<p>Yii provides various cache components that can store cached data in different media. The following
is a summary of the available cache components:</p>
<ul>
<li><p><span class="broken-link">\yii\caching\ApcCache</span>: uses PHP <a href="http://php.net/manual/en/book.apc.php">APC</a> extension. This option can be
considered as the fastest one when dealing with cache for a centralized thick application (e.g. one
server, no dedicated load balancers, etc.).</p>
</li>
<li><p><span class="broken-link">\yii\caching\DbCache</span>: uses a database table to store cached data. By default, it will create and use a
<a href="http://sqlite.org/">SQLite3</a> database under the runtime directory. You can explicitly specify a database for
it to use by setting its <code>db</code> property.</p>
</li>
<li><p><span class="broken-link">\yii\caching\DummyCache</span>: presents dummy cache that does no caching at all. The purpose of this component
is to simplify the code that needs to check the availability of cache. For example, during development or if
the server doesn't have actual cache support, we can use this cache component. When an actual cache support
is enabled, we can switch to use the corresponding cache component. In both cases, we can use the same
code <code>Yii::$app-&gt;cache-&gt;get($key)</code> to attempt retrieving a piece of data without worrying that
<code>Yii::$app-&gt;cache</code> might be <code>null</code>.</p>
</li>
<li><p><span class="broken-link">\yii\caching\FileCache</span>: uses standard files to store cached data. This is particular suitable
to cache large chunk of data (such as pages).</p>
</li>
<li><p><span class="broken-link">\yii\caching\MemCache</span>: uses PHP <a href="http://php.net/manual/en/book.memcache.php">memcache</a>
and <a href="http://php.net/manual/en/book.memcached.php">memcached</a> extensions. This option can be considered as
the fastest one when dealing with cache in a distributed applications (e.g. with several servers, load
balancers, etc.)</p>
</li>
<li><p><span class="broken-link">\yii\caching\RedisCache</span>: implements a cache component based on <a href="http://redis.io/">Redis</a> key-value store
(redis version 2.6 or higher is required).</p>
</li>
<li><p><span class="broken-link">\yii\caching\WinCache</span>: uses PHP <a href="http://iis.net/downloads/microsoft/wincache-extension">WinCache</a>
(<a href="http://php.net/manual/en/book.wincache.php">see also</a>) extension.</p>
</li>
<li><p><span class="broken-link">\yii\caching\XCache</span>: uses PHP <a href="http://xcache.lighttpd.net/">XCache</a> extension.</p>
</li>
<li><p><a href="http://files.zend.com/help/Zend-Server-6/zend-server.htm#data_cache_component.htm">Zend Data Cache</a>
as the underlying caching medium.</p>
</li>
</ul>
<p>Tip: because all these cache components extend from the same base class <span class="broken-link">Cache</span>, one can switch to use
a different type of cache without modifying the code that uses cache.</p>
<p>Caching can be used at different levels. At the lowest level, we use cache to store a single piece of data,
such as a variable, and we call this data caching. At the next level, we store in cache a page fragment which
is generated by a portion of a view script. And at the highest level, we store a whole page in cache and serve
it from cache as needed.</p>
<p>In the next few subsections, we elaborate how to use cache at these levels.</p>
<p>Note, by definition, cache is a volatile storage medium. It does not ensure the existence of the cached
data even if it does not expire. Therefore, do not use cache as a persistent storage (e.g. do not use cache
to store session data or other valuable information).</p>
<h2>Data Caching <a href="#data-caching" name="data-caching" class="hashlink">&para;</a></h2><p>Data caching is about storing some PHP variable in cache and retrieving it later from cache. For this purpose,
the cache component base class <span class="broken-link">\yii\caching\Cache</span> provides two methods that are used most of the time:
<span class="broken-link">set()</span> and <span class="broken-link">get()</span>. Note, only serializable variables and objects could be cached successfully.</p>
<p>To store a variable <code>$value</code> in cache, we choose a unique <code>$key</code> and call <span class="broken-link">set()</span> to store it:</p>
<pre><code class="language-php"><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">);</span></code></pre>
<p>The cached data will remain in the cache forever unless it is removed because of some caching policy
(e.g. caching space is full and the oldest data are removed). To change this behavior, we can also supply
an expiration parameter when calling <span class="broken-link">set()</span> so that the data will be removed from the cache after
a certain period of time:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;keep&nbsp;the&nbsp;value&nbsp;in&nbsp;cache&nbsp;for&nbsp;at&nbsp;most&nbsp;45&nbsp;seconds<br /></span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">45</span><span style="color: #007700">);</span></code></pre>
<p>Later when we need to access this variable (in either the same or a different web request), we call <span class="broken-link">get()</span>
with the key to retrieve it from cache. If the value returned is <code>false</code>, it means the value is not available
in cache and we should regenerate it:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getCachedData</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #FF8000">/*&nbsp;generate&nbsp;unique&nbsp;key&nbsp;here&nbsp;*/</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCache</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #FF8000">/*&nbsp;regenerate&nbsp;value&nbsp;because&nbsp;it&nbsp;is&nbsp;not&nbsp;found&nbsp;in&nbsp;cache&nbsp;and&nbsp;then&nbsp;save&nbsp;it&nbsp;in&nbsp;cache&nbsp;for&nbsp;later&nbsp;use&nbsp;*/</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br />}</span></code></pre>
<p>This is the common pattern of arbitrary data caching for general use.</p>
<p>When choosing the key for a variable to be cached, make sure the key is unique among all other variables that
may be cached in the application. It is <strong>NOT</strong> required that the key is unique across applications because
the cache component is intelligent enough to differentiate keys for different applications.</p>
<p>Some cache storages, such as MemCache, APC, support retrieving multiple cached values in a batch mode,
which may reduce the overhead involved in retrieving cached data. A method named <span class="broken-link">mget()</span> is provided
to exploit this feature. In case the underlying cache storage does not support this feature,
<span class="broken-link">mget()</span> will still simulate it.</p>
<p>To remove a cached value from cache, call <span class="broken-link">delete()</span>; and to remove everything from cache, call <span class="broken-link">flush()</span>.
Be very careful when calling <span class="broken-link">flush()</span> because it also removes cached data that are from other applications.</p>
<p>Note, because <span class="broken-link">Cache</span> implements <code>ArrayAccess</code>, a cache component can be used liked an array. The followings
are some examples:</p>
<pre><code class="language-php"><span style="color: #0000BB">$cache&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getComponent</span><span style="color: #007700">(</span><span style="color: #DD0000">'cache'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$cache</span><span style="color: #007700">[</span><span style="color: #DD0000">'var1'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$value1</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;equivalent&nbsp;to:&nbsp;$cache-&gt;set('var1',&nbsp;$value1);<br /></span><span style="color: #0000BB">$value2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$cache</span><span style="color: #007700">[</span><span style="color: #DD0000">'var2'</span><span style="color: #007700">];&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;equivalent&nbsp;to:&nbsp;$value2&nbsp;=&nbsp;$cache-&gt;get('var2');</span></code></pre>
<h3>Cache Dependency <a href="#cache-dependency" name="cache-dependency" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.data#cache-dependency">http://www.yiiframework.com/doc/guide/1.1/en/caching.data#cache-dependency</a></p>
<h3>Query Caching <a href="#query-caching" name="query-caching" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.data#query-caching">http://www.yiiframework.com/doc/guide/1.1/en/caching.data#query-caching</a></p>
<h2>Fragment Caching <a href="#fragment-caching" name="fragment-caching" class="hashlink">&para;</a></h2><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment">http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment</a></p>
<h3>Caching Options <a href="#caching-options" name="caching-options" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment#caching-options">http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment#caching-options</a></p>
<h3>Nested Caching <a href="#nested-caching" name="nested-caching" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment#nested-caching">http://www.yiiframework.com/doc/guide/1.1/en/caching.fragment#nested-caching</a></p>
<h2>Dynamic Content <a href="#dynamic-content" name="dynamic-content" class="hashlink">&para;</a></h2><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.dynamic">http://www.yiiframework.com/doc/guide/1.1/en/caching.dynamic</a></p>
<h2>Page Caching <a href="#page-caching" name="page-caching" class="hashlink">&para;</a></h2><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.page">http://www.yiiframework.com/doc/guide/1.1/en/caching.page</a></p>
<h3>Output Caching <a href="#output-caching" name="output-caching" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.page#output-caching">http://www.yiiframework.com/doc/guide/1.1/en/caching.page#output-caching</a></p>
<h3>HTTP Caching <a href="#http-caching" name="http-caching" class="hashlink">&para;</a></h3><p>TBD: <a href="http://www.yiiframework.com/doc/guide/1.1/en/caching.page#http-caching">http://www.yiiframework.com/doc/guide/1.1/en/caching.page#http-caching</a></p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Mon, 19 Jan 2015 02:32:13 +0700</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>

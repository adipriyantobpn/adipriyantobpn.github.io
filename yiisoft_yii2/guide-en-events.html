<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/4b76110e/css/bootstrap.css" rel="stylesheet">
<link href="./assets/710de68d/style.css" rel="stylesheet">
<script src="./assets/75e46bf0/jquery.js"></script>
<script src="./assets/4b76110e/js/bootstrap.js"></script>
<script src="./assets/a44c75fa/jssearch.js"></script>    <title>Yii Framework 2.0 API Documentation</title>
</head>
<body>

<div class="wrap">
    <nav id="w46" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w46-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii Framework 2.0 API Documentation</a></div><div id="w46-collapse" class="collapse navbar-collapse"><ul id="w47" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li><a href="./guide-en-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Events <a href="#events" name="events" class="hashlink">&para;</a></h1><p>Event is a way to "inject" custom code into existing code at certain places. For example, a comment object can trigger
an "add" event when the user adds a comment. We can write custom code and attach it to this event so that when the event
is triggered (i.e. comment will be added), our custom code will be executed.</p>
<p>Events are very useful both to make your components flexible and to hook into framework and extensions workflow.</p>
<h2>Triggering events <a href="#triggering-events" name="triggering-events" class="hashlink">&para;</a></h2><p>Any component can trigger events using <code>trigger</code> method:</p>
<pre><code class="language-php"><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trigger</span><span style="color: #007700">(</span><span style="color: #DD0000">'myEvent'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;or<br /><br /></span><span style="color: #0000BB">$event&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">CreateUserEvent</span><span style="color: #007700">();&nbsp;</span><span style="color: #FF8000">//&nbsp;extended&nbsp;from&nbsp;yii\base\Event<br /></span><span style="color: #0000BB">$event</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">userName&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Alexander'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trigger</span><span style="color: #007700">(</span><span style="color: #DD0000">'createUserEvent'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$event</span><span style="color: #007700">);</span></code></pre>
<p>Event name should be unique within the class it is defined at. Event names are <em>case-sensitive</em>. It is a good practice
to define event names using class constants:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">Mailer&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Component<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;</span><span style="color: #0000BB">EVENT_SEND_EMAIL&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'sendEmail'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">send</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trigger</span><span style="color: #007700">(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">EVENT_SEND_EMAIL</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<h2>Attaching event handlers <a href="#attaching-event-handlers" name="attaching-event-handlers" class="hashlink">&para;</a></h2><p>One or multiple PHP callbacks, called <em>event handlers</em>, can be attached to an event. When an event is raised, the event
handlers will be invoked automatically in the order they were attached.</p>
<p>There are two main methods of attaching event handlers. It can be done either via code or via application config.</p>
<blockquote><p>Tip: In order to get up to date list of framework and extension events search code for <code>-&gt;trigger</code>.</p>
</blockquote>
<h3>Attaching event handlers via code <a href="#attaching-event-handlers-via-code" name="attaching-event-handlers-via-code" class="hashlink">&para;</a></h3><p>You can assign event handlers using <code>on</code> method of the component instance. The method's first argument is the name of
the event to watch for; the second is the handler to be called when that event occurs:</p>
<pre><code class="language-php"><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$handler</span><span style="color: #007700">);</span></code></pre>
<p>The handler must be a valid PHP callback. This could be represented as:</p>
<ul>
<li>The name of a global function.</li>
<li>An array consisting of a model name and method name.</li>
<li>An array consisting of an object and a method name.</li>
<li>An anonymous function.</li>
</ul>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;Global&nbsp;function:<br /></span><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'functionName'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Model&nbsp;and&nbsp;method&nbsp;names:<br /></span><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'Modelname'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'functionName'</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">//&nbsp;Object&nbsp;and&nbsp;method&nbsp;name:<br /></span><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;[</span><span style="color: #0000BB">$obj</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'functionName'</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">//&nbsp;Anonymous&nbsp;function:<br /></span><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;function&nbsp;(</span><span style="color: #0000BB">$event</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Use&nbsp;$event.<br /></span><span style="color: #007700">});</span></code></pre>
<p>As shown in the anonymous function example, the event handling function must be defined so that it takes one argument.
This will be an <span class="broken-link">yii\base\Event</span> object.</p>
<p>In order to pass extra data supply it via third argument:</p>
<pre><code class="language-php"><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;function&nbsp;(</span><span style="color: #0000BB">$event</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;the&nbsp;extra&nbsp;data&nbsp;can&nbsp;be&nbsp;accessed&nbsp;via&nbsp;$event-&gt;data<br /></span><span style="color: #007700">},&nbsp;</span><span style="color: #0000BB">$extraData</span><span style="color: #007700">);</span></code></pre>
<h3>Attaching event handlers via config <a href="#attaching-event-handlers-via-config" name="attaching-event-handlers-via-config" class="hashlink">&para;</a></h3><p>It is possible to use application config to attach event hanelers:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'components'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'on&nbsp;afterOpen'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;function&nbsp;(</span><span style="color: #0000BB">$event</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;do&nbsp;something&nbsp;right&nbsp;after&nbsp;connected&nbsp;to&nbsp;database<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;],<br />];</span></code></pre>
<h2>Removing Event Handlers <a href="#removing-event-handlers" name="removing-event-handlers" class="hashlink">&para;</a></h2><p>The correspondoing <code>off</code> method removes an event handler:</p>
<pre><code class="language-php"><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">off</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">);</span></code></pre>
<p>Yii supports the ability to associate multiple handlers with the same event. When using <code>off</code> as in the above,
every handler is removed. To remove only a specific handler, provide that as the second argument to <code>off</code>:</p>
<pre><code class="language-php"><span style="color: #0000BB">$component</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">off</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$handler</span><span style="color: #007700">);</span></code></pre>
<p>The <code>$handler</code> should be presented in the <code>off</code> method in the same way as was presented in <code>on</code> in order to remove it.</p>
<h2>Global Events <a href="#global-events" name="global-events" class="hashlink">&para;</a></h2><p>You can use "global" events instead of per-component ones. To trigger a global event use an application instance instead
of specific component:</p>
<pre><code class="language-php"><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">trigger</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">);</span></code></pre>
<p>In order to attach a handler to it use the following:</p>
<pre><code class="language-php"><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">$eventName</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$handler</span><span style="color: #007700">);</span></code></pre>
<h2>Class Events <a href="#class-events" name="class-events" class="hashlink">&para;</a></h2><p>It is possible to attach event handlers to all instances of a class instead of individual instances. To do so, use
the static <code>Event::on</code> method:</p>
<pre><code class="language-php"><span style="color: #0000BB">Event</span><span style="color: #007700">::</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">ActiveRecord</span><span style="color: #007700">::</span><span style="color: #0000BB">className</span><span style="color: #007700">(),&nbsp;</span><span style="color: #0000BB">ActiveRecord</span><span style="color: #007700">::</span><span style="color: #0000BB">EVENT_AFTER_INSERT</span><span style="color: #007700">,&nbsp;function&nbsp;(</span><span style="color: #0000BB">$event</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">trace</span><span style="color: #007700">(</span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$event</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sender</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'&nbsp;is&nbsp;inserted.'</span><span style="color: #007700">);<br />});</span></code></pre>
<p>The code above defines a handler that will be triggered for every Active Record object's <code>EVENT_AFTER_INSERT</code> event.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Mon, 19 Jan 2015 03:03:04 +0700</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
